{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/marienel/Downloads/clinic-management-system/lib/auth.ts"],"sourcesContent":["export interface User {\n  id: string\n  fullName: string\n  email: string\n  role: \"student\" | \"admin\" | \"clinic_staff\"\n  age?: number\n  address?: string\n  phone?: string\n  avatar?: string\n}\n\nexport interface Patient {\n  id: string\n  name: string\n  age: number\n  gender: \"Male\" | \"Female\"\n  phone: string\n  email: string\n  address?: string\n  attachments?: string[]\n}\n\n// Password validation: min 1 uppercase, 1 number, 1 special char\nexport const validatePassword = (password: string): { valid: boolean; errors: string[] } => {\n  const errors: string[] = []\n  if (password.length < 8) errors.push(\"Password must be at least 8 characters\")\n  if (!/[A-Z]/.test(password)) errors.push(\"Password must contain uppercase letter\")\n  if (!/[0-9]/.test(password)) errors.push(\"Password must contain a number\")\n  if (!/[!@#$%^&*()_+\\-=[\\]{};':\"\\\\|,.<>/?]/.test(password)) errors.push(\"Password must contain special character\")\n  return { valid: errors.length === 0, errors }\n}\n\n// Email validation\nexport const validateEmail = (email: string): boolean => {\n  return email.includes(\"@\") && email.includes(\".\")\n}\n\n// Phone validation - numbers only\nexport const validatePhone = (phone: string): boolean => {\n  return /^[0-9+\\s\\-()]*$/.test(phone) && phone.replace(/\\D/g, \"\").length >= 10\n}\n"],"names":[],"mappings":";;;;;;;;AAuBO,MAAM,mBAAmB,CAAC;IAC/B,MAAM,SAAmB,EAAE;IAC3B,IAAI,SAAS,MAAM,GAAG,GAAG,OAAO,IAAI,CAAC;IACrC,IAAI,CAAC,QAAQ,IAAI,CAAC,WAAW,OAAO,IAAI,CAAC;IACzC,IAAI,CAAC,QAAQ,IAAI,CAAC,WAAW,OAAO,IAAI,CAAC;IACzC,IAAI,CAAC,sCAAsC,IAAI,CAAC,WAAW,OAAO,IAAI,CAAC;IACvE,OAAO;QAAE,OAAO,OAAO,MAAM,KAAK;QAAG;IAAO;AAC9C;AAGO,MAAM,gBAAgB,CAAC;IAC5B,OAAO,MAAM,QAAQ,CAAC,QAAQ,MAAM,QAAQ,CAAC;AAC/C;AAGO,MAAM,gBAAgB,CAAC;IAC5B,OAAO,kBAAkB,IAAI,CAAC,UAAU,MAAM,OAAO,CAAC,OAAO,IAAI,MAAM,IAAI;AAC7E"}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/marienel/Downloads/clinic-management-system/app/%28auth%29/signup/page.tsx"],"sourcesContent":["\"use client\"\n\nimport type React from \"react\"\nimport { useState, useCallback } from \"react\"\nimport Link from \"next/link\"\nimport { Eye, EyeOff, ChevronDown, Check, X } from \"lucide-react\"\nimport { useRouter } from \"next/navigation\"\nimport { validateEmail, validatePassword } from \"@/lib/auth\"\n\nexport default function SignupPage() {\n  const [username, setUsername] = useState(\"\")\n  const [usernameError, setUsernameError] = useState(\"\")\n  const [usernameChecking, setUsernameChecking] = useState(false)\n  const [usernameAvailable, setUsernameAvailable] = useState<boolean | null>(null)\n\n  const [fullName, setFullName] = useState(\"\")\n  const [email, setEmail] = useState(\"\")\n  const [password, setPassword] = useState(\"\")\n\n  const [showPassword, setShowPassword] = useState(false)\n  const [errors, setErrors] = useState<string[]>([])\n  const [isLoading, setIsLoading] = useState(false)\n  const router = useRouter()\n\n  // Check username availability with debounce\n  const checkUsernameAvailability = useCallback(async (user: string) => {\n    if (!user || user.length < 3) {\n      setUsernameAvailable(null)\n      setUsernameError(\"\")\n      return\n    }\n\n    setUsernameChecking(true)\n    try {\n      const response = await fetch(\"/api/auth/check-username\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ username: user }),\n      })\n      const data = await response.json()\n      if (data.available) {\n        setUsernameAvailable(true)\n        setUsernameError(\"\")\n      } else {\n        setUsernameAvailable(false)\n        setUsernameError(\"Username is already taken\")\n      }\n    } catch (error) {\n      console.error(\"Error checking username:\", error)\n      setUsernameError(\"Error checking username availability\")\n    } finally {\n      setUsernameChecking(false)\n    }\n  }, [])\n\n  const handleUsernameChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = e.target.value\n    setUsername(value)\n\n    if (value && value.length < 3) {\n      setUsernameError(\"Username must be at least 3 characters\")\n      setUsernameAvailable(null)\n    } else if (value && !/^[a-zA-Z0-9_-]+$/.test(value)) {\n      setUsernameError(\"Username can only contain letters, numbers, underscore, and dash\")\n      setUsernameAvailable(null)\n    } else {\n      setUsernameError(\"\")\n      const timer = setTimeout(() => {\n        checkUsernameAvailability(value)\n      }, 500)\n      return () => clearTimeout(timer)\n    }\n  }\n\n  const handleSignup = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setErrors([])\n    setIsLoading(true)\n\n    const newErrors: string[] = []\n\n    if (!username.trim()) newErrors.push(\"Username is required\")\n    else if (username.length < 3) newErrors.push(\"Username must be at least 3 characters\")\n    else if (!/^[a-zA-Z0-9_-]+$/.test(username))\n      newErrors.push(\"Username can only contain letters, numbers, underscore, and dash\")\n    else if (!usernameAvailable) newErrors.push(\"Username is not available\")\n\n    if (!fullName.trim()) newErrors.push(\"Full name is required\")\n    if (!email.trim()) newErrors.push(\"Email is required\")\n    else if (!validateEmail(email)) newErrors.push(\"Email must contain @ symbol\")\n    if (!password) newErrors.push(\"Password is required\")\n    else {\n      const passwordValidation = validatePassword(password)\n      if (!passwordValidation.valid) newErrors.push(...passwordValidation.errors)\n    }\n\n    if (newErrors.length > 0) {\n      setErrors(newErrors)\n      setIsLoading(false)\n      return\n    }\n\n    try {\n      const response = await fetch(\"/api/auth/signup\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ username, fullName, email, password }),\n      })\n      const data = await response.json()\n      if (!response.ok) {\n        setErrors([data.error || \"Signup failed\"])\n        setIsLoading(false)\n        return\n      }\n      router.push(\"/login\")\n    } catch (error) {\n      console.error(\"Signup error:\", error)\n      setErrors([\"An error occurred. Please try again.\"])\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-red-50 via-green-50 to-blue-50 flex items-center justify-center p-4\">\n      <div className=\"w-full max-w-md\">\n        <div className=\"bg-white rounded-3xl shadow-2xl p-8 space-y-8\">\n          <div className=\"text-center\">\n            <h1 className=\"text-3xl font-bold text-[#8B3A3A] mb-2\">Clinic Management</h1>\n            <p className=\"text-gray-500\">Create your account</p>\n          </div>\n\n          {errors.length > 0 && (\n            <div className=\"bg-red-50 border border-red-200 rounded-lg p-3\">\n              <ul className=\"space-y-1\">\n                {errors.map((error, idx) => (\n                  <li key={idx} className=\"text-red-700 text-sm\">• {error}</li>\n                ))}\n              </ul>\n            </div>\n          )}\n\n          <form onSubmit={handleSignup} className=\"space-y-6\">\n            {/* Username Input */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-900 mb-2\">Username</label>\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  value={username}\n                  onChange={handleUsernameChange}\n                  placeholder=\"Choose a unique username\"\n                  className={`w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 bg-gray-50 pr-10 ${\n                    usernameError\n                      ? \"border-red-300 focus:ring-red-500\"\n                      : usernameAvailable\n                      ? \"border-green-300 focus:ring-green-500\"\n                      : \"border-gray-300 focus:ring-[#8B3A3A]\"\n                  }`}\n                />\n                {usernameChecking && (\n                  <div className=\"absolute right-4 top-3\">\n                    <div className=\"animate-spin h-5 w-5 border-2 border-[#8B3A3A] border-t-transparent rounded-full\"></div>\n                  </div>\n                )}\n                {!usernameChecking && usernameAvailable && <Check className=\"absolute right-4 top-3 text-green-500\" size={20} />}\n                {!usernameChecking && usernameError && <X className=\"absolute right-4 top-3 text-red-500\" size={20} />}\n              </div>\n              {usernameError && <p className=\"text-red-600 text-xs mt-1\">{usernameError}</p>}\n              {usernameAvailable && <p className=\"text-green-600 text-xs mt-1\">✓ Username is available</p>}\n              <p className=\"text-gray-500 text-xs mt-1\">3+ characters, letters, numbers, underscore, dash only</p>\n            </div>\n\n            {/* Full Name Input */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-900 mb-2\">Full Name</label>\n              <input\n                type=\"text\"\n                value={fullName}\n                onChange={(e) => setFullName(e.target.value)}\n                placeholder=\"Enter your full name\"\n                className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#8B3A3A] bg-gray-50\"\n              />\n            </div>\n\n            {/* Email Input */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-900 mb-2\">Email</label>\n              <input\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                placeholder=\"Enter your email\"\n                className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#8B3A3A] bg-gray-50\"\n              />\n            </div>\n\n            {/* Password Input */}\n            <div>\n              <label className=\"block text-sm font-semibold text-gray-900 mb-2\">Password</label>\n              <div className=\"relative\">\n                <input\n                  type={showPassword ? \"text\" : \"password\"}\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  placeholder=\"Enter your password\"\n                  className=\"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#8B3A3A] bg-gray-50\"\n                />\n                <button type=\"button\" onClick={() => setShowPassword(!showPassword)} className=\"absolute right-4 top-3 text-gray-400\">\n                  {showPassword ? <EyeOff size={20} /> : <Eye size={20} />}\n                </button>\n              </div>\n            </div>\n\n\n\n            <button\n              type=\"submit\"\n              disabled={isLoading || !usernameAvailable}\n              className=\"w-full bg-[#8B3A3A] text-white py-3 rounded-lg font-semibold hover:bg-[#6D2E2E] transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n            >\n              {isLoading ? \"Creating Account...\" : \"Create Account\"}\n            </button>\n          </form>\n\n          <div className=\"text-center\">\n            <Link href=\"/login\" className=\"text-[#8B3A3A] hover:underline font-medium\">\n              Already have an account? Login\n            </Link>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}}]
}