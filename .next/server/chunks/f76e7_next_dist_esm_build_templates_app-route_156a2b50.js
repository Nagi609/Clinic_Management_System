module.exports=[200,e=>{"use strict";var t=e.i(14113),r=e.i(61846),n=e.i(33149),a=e.i(25578),s=e.i(22240),i=e.i(87645),o=e.i(34797),l=e.i(71903),u=e.i(98763),d=e.i(29936),c=e.i(14342),p=e.i(50361),h=e.i(97679),m=e.i(6108),f=e.i(20634),y=e.i(98776),R=e.i(93695);e.i(21531);var g=e.i(75441),C=e.i(16334),v=e.i(62294);let x=e=>!!e&&!!e.trim()&&/^[a-zA-Z\s]*$/.test(e.trim()),N=e=>{if(!e)return null;try{return JSON.stringify(e)}catch{return null}};async function w(e){try{let t=e.headers.get("x-user-id");if(!t)return C.NextResponse.json({error:"Unauthorized"},{status:401});let r=await v.default.patient.findMany({where:{userId:t},orderBy:{createdAt:"desc"}});return C.NextResponse.json({patients:r})}catch(e){return console.error("Get patients error:",e),C.NextResponse.json({error:"Internal server error"},{status:500})}}async function E(e){try{let t=e.headers.get("x-user-id");if(!t)return C.NextResponse.json({error:"Unauthorized"},{status:401});let{firstName:r,middleName:n,lastName:a,suffix:s,dateOfBirth:i,gender:o,phone:l,email:u,address:d,role:c,idNumber:p,program:h,course:m,yearLevel:f,block:y,department:R,staffCategory:g,pastIllnesses:w,surgeries:E,currentMedication:P,allergies:A,medicalNotes:b,primaryContactName:q,primaryContactRelationship:I,primaryContactPhone:T,primaryContactAddress:_,secondaryContactName:j,secondaryContactRelationship:M,secondaryContactPhone:S,secondaryContactAddress:O,attachments:U}=await e.json(),D=[];if(r&&x(r)||D.push("First name is required and must contain only letters"),n&&!x(n)&&D.push("Middle name must contain only letters"),a&&x(a)||D.push("Last name is required and must contain only letters"),s&&!x(s)&&D.push("Suffix must contain only letters"),i||D.push("Date of birth is required"),o||D.push("Gender is required"),l&&/^09\d{9}$/.test(l)||D.push("Phone must start with 09 and be exactly 11 digits"),c&&["student","teaching_staff","non_teaching_staff"].includes(c)||D.push("Valid role is required"),p&&/^[a-zA-Z0-9-]+$/.test(p)||D.push("ID number is required and can only contain letters, numbers, and dashes"),"student"===c&&(h&&["CICT","CBME"].includes(h)||D.push("Valid program (CICT or CBME) is required for students"),m||D.push("Course is required for students"),(!f||f<1||f>4)&&D.push("Valid year level (1-4) is required for students"),(!y||y<1||y>5)&&D.push("Valid block (1-5) is required for students")),"teaching_staff"!==c||R&&["CICT","CBME"].includes(R)||D.push("Valid program (CICT or CBME) is required for teaching staff"),"non_teaching_staff"!==c||g&&["Administrative","Security","Maintenance","Support","Clinic"].includes(g)||D.push("Valid category is required for non-teaching staff"),q&&q.trim()||D.push("Primary contact name is required"),I&&I.trim()||D.push("Primary contact relationship is required"),T&&/^09\d{9}$/.test(T)||D.push("Primary contact phone must start with 09 and be exactly 11 digits"),D.length>0)return C.NextResponse.json({errors:D},{status:400});let k=await v.default.patient.create({data:{firstName:r,middleName:n||null,lastName:a,suffix:s||null,dateOfBirth:i,gender:o,phone:l,email:u||null,address:d||null,role:c,idNumber:p,program:"student"===c?h:null,course:"student"===c?m:null,yearLevel:"student"===c?f:null,block:"student"===c?y:null,department:"teaching_staff"===c?R:null,staffCategory:"non_teaching_staff"===c?g:null,pastIllnesses:w||null,surgeries:E||null,currentMedication:P||null,allergies:A||null,medicalNotes:b||null,primaryContactName:q,primaryContactRelationship:I,primaryContactPhone:T,primaryContactAddress:_||null,secondaryContactName:j||null,secondaryContactRelationship:M||null,secondaryContactPhone:S||null,secondaryContactAddress:O||null,attachments:N(U),userId:t}});return C.NextResponse.json({patient:k},{status:201})}catch(e){return console.error("Create patient error:",e),C.NextResponse.json({error:"Internal server error"},{status:500})}}async function P(e){try{let t=e.headers.get("x-user-id");if(!t)return C.NextResponse.json({error:"Unauthorized"},{status:401});let{id:r,firstName:n,middleName:a,lastName:s,suffix:i,dateOfBirth:o,gender:l,phone:u,email:d,address:c,role:p,idNumber:h,program:m,course:f,yearLevel:y,block:R,department:g,staffCategory:w,pastIllnesses:E,surgeries:P,currentMedication:A,allergies:b,medicalNotes:q,primaryContactName:I,primaryContactRelationship:T,primaryContactPhone:_,primaryContactAddress:j,secondaryContactName:M,secondaryContactRelationship:S,secondaryContactPhone:O,secondaryContactAddress:U,attachments:D}=await e.json();if(!r)return C.NextResponse.json({error:"Patient ID required"},{status:400});let k=await v.default.patient.findUnique({where:{id:r}});if(!k||k.userId!==t)return C.NextResponse.json({error:"Patient not found or unauthorized"},{status:404});let H=[];if(n&&!x(n)&&H.push("First name must contain only letters"),a&&!x(a)&&H.push("Middle name must contain only letters"),s&&!x(s)&&H.push("Last name must contain only letters"),i&&!x(i)&&H.push("Suffix must contain only letters"),u&&!/^09\d{9}$/.test(u)&&H.push("Phone must start with 09 and be exactly 11 digits"),h&&!/^[a-zA-Z0-9-]+$/.test(h)&&H.push("ID number can only contain letters, numbers, and dashes"),I&&!I.trim()&&H.push("Primary contact name cannot be empty"),T&&!T.trim()&&H.push("Primary contact relationship cannot be empty"),_&&!/^09\d{9}$/.test(_)&&H.push("Primary contact phone must start with 09 and be exactly 11 digits"),H.length>0)return C.NextResponse.json({errors:H},{status:400});let $=await v.default.patient.update({where:{id:r},data:{firstName:n??k.firstName,middleName:void 0!==a?a:k.middleName,lastName:s??k.lastName,suffix:void 0!==i?i:k.suffix,dateOfBirth:o??k.dateOfBirth,gender:l??k.gender,phone:u??k.phone,email:void 0!==d?d:k.email,address:void 0!==c?c:k.address,role:p??k.role,idNumber:h??k.idNumber,program:"student"===p?m??k.program:null,course:"student"===p?f??k.course:null,yearLevel:"student"===p?y??k.yearLevel:null,block:"student"===p?R??k.block:null,department:"teaching_staff"===p?g??k.department:null,staffCategory:"non_teaching_staff"===p?w??k.staffCategory:null,pastIllnesses:void 0!==E?E:k.pastIllnesses,surgeries:void 0!==P?P:k.surgeries,currentMedication:void 0!==A?A:k.currentMedication,allergies:void 0!==b?b:k.allergies,medicalNotes:void 0!==q?q:k.medicalNotes,primaryContactName:I??k.primaryContactName,primaryContactRelationship:T??k.primaryContactRelationship,primaryContactPhone:_??k.primaryContactPhone,primaryContactAddress:void 0!==j?j:k.primaryContactAddress,secondaryContactName:void 0!==M?M:k.secondaryContactName,secondaryContactRelationship:void 0!==S?S:k.secondaryContactRelationship,secondaryContactPhone:void 0!==O?O:k.secondaryContactPhone,secondaryContactAddress:void 0!==U?U:k.secondaryContactAddress,attachments:D?N(D):k.attachments}});return C.NextResponse.json({patient:$})}catch(e){return console.error("Update patient error:",e),C.NextResponse.json({error:"Internal server error"},{status:500})}}async function A(e){try{let t=e.headers.get("x-user-id");if(!t)return C.NextResponse.json({error:"Unauthorized"},{status:401});let{id:r}=await e.json();if(!r)return C.NextResponse.json({error:"Patient ID required"},{status:400});let n=await v.default.patient.findUnique({where:{id:r}});if(!n||n.userId!==t)return C.NextResponse.json({error:"Patient not found or unauthorized"},{status:404});return await v.default.patient.delete({where:{id:r}}),C.NextResponse.json({message:"Patient deleted"})}catch(e){return console.error("Delete patient error:",e),C.NextResponse.json({error:"Internal server error"},{status:500})}}e.s(["DELETE",()=>A,"GET",()=>w,"POST",()=>E,"PUT",()=>P],32324);var b=e.i(32324);let q=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/patients/route",pathname:"/api/patients",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/app/api/patients/route.ts",nextConfigOutput:"",userland:b}),{workAsyncStorage:I,workUnitAsyncStorage:T,serverHooks:_}=q;function j(){return(0,n.patchFetch)({workAsyncStorage:I,workUnitAsyncStorage:T})}async function M(e,t,n){q.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let C="/api/patients/route";C=C.replace(/\/index$/,"")||"/";let v=await q.prepare(e,t,{srcPage:C,multiZoneDraftMode:!1});if(!v)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:x,params:N,nextConfig:w,parsedUrl:E,isDraftMode:P,prerenderManifest:A,routerServerContext:b,isOnDemandRevalidate:I,revalidateOnlyGenerated:T,resolvedPathname:_,clientReferenceManifest:j,serverActionsManifest:M}=v,S=(0,l.normalizeAppPath)(C),O=!!(A.dynamicRoutes[S]||A.routes[_]),U=async()=>((null==b?void 0:b.render404)?await b.render404(e,t,E,!1):t.end("This page could not be found"),null);if(O&&!P){let e=!!A.routes[_],t=A.dynamicRoutes[S];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await U();throw new R.NoFallbackError}}let D=null;!O||q.isDev||P||(D="/index"===(D=_)?"/":D);let k=!0===q.isDev||!O,H=O&&!k;M&&j&&(0,i.setReferenceManifestsSingleton)({page:C,clientReferenceManifest:j,serverActionsManifest:M,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:M})});let $=e.method||"GET",B=(0,s.getTracer)(),L=B.getActiveScopeSpan(),z={params:N,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:k,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>q.onRequestError(e,t,n,b)},sharedContext:{buildId:x}},F=new u.NodeNextRequest(e),V=new u.NodeNextResponse(t),K=d.NextRequestAdapter.fromNodeNextRequest(F,(0,d.signalFromNodeResponse)(t));try{let i=async e=>q.handle(K,z).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=B.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==c.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${$} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${$} ${C}`)}),o=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var s,l;let u=async({previousCacheEntry:r})=>{try{if(!o&&I&&T&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await i(a);e.fetchMetrics=z.renderOpts.fetchMetrics;let l=z.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let u=z.renderOpts.collectedTags;if(!O)return await (0,h.sendResponse)(F,V,s,z.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(s.headers);u&&(t[y.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==z.renderOpts.collectedRevalidate&&!(z.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&z.renderOpts.collectedRevalidate,n=void 0===z.renderOpts.collectedExpire||z.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:z.renderOpts.collectedExpire;return{value:{kind:g.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await q.onRequestError(e,t,{routerKind:"App Router",routePath:C,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:I})},b),t}},d=await q.handleResponse({req:e,nextConfig:w,cacheKey:D,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:I,revalidateOnlyGenerated:T,responseGenerator:u,waitUntil:n.waitUntil,isMinimalMode:o});if(!O)return null;if((null==d||null==(s=d.value)?void 0:s.kind)!==g.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(l=d.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",I?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),P&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let c=(0,m.fromNodeOutgoingHttpHeaders)(d.value.headers);return o&&O||c.delete(y.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||c.get("Cache-Control")||c.set("Cache-Control",(0,f.getCacheControlHeader)(d.cacheControl)),await (0,h.sendResponse)(F,V,new Response(d.value.body,{headers:c,status:d.value.status||200})),null};L?await l(L):await B.withPropagatedContext(e.headers,()=>B.trace(c.BaseServerSpan.handleRequest,{spanName:`${$} ${C}`,kind:s.SpanKind.SERVER,attributes:{"http.method":$,"http.target":e.url}},l))}catch(t){if(t instanceof R.NoFallbackError||await q.onRequestError(e,t,{routerKind:"App Router",routePath:S,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:I})}),O)throw t;return await (0,h.sendResponse)(F,V,new Response(null,{status:500})),null}}e.s(["handler",()=>M,"patchFetch",()=>j,"routeModule",()=>q,"serverHooks",()=>_,"workAsyncStorage",()=>I,"workUnitAsyncStorage",()=>T],200)}];

//# sourceMappingURL=f76e7_next_dist_esm_build_templates_app-route_156a2b50.js.map